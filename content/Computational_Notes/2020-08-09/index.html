---
title: "Latent Dual Change Models"
date: "2020-08-09"
summary: "-----"
---



<p>I begin with an intercept-only model in a latent change framework and then build to a full dual change model. SEM images in this post come from a lecture by <a href="https://hdfs.msu.edu/people/faculty/nuttall-amy-k-phd">Amy Nuttall</a>. Two notes about the models and code below. First, the initial models will not fit well because they are too simple. The DGP uses both constant and proportion change (hence, “dual-change”) whereas the first few models only estimate an intercept. Second, I use the <code>sem</code> rather than <code>growth</code> command in <code>lavaan</code> because it forces me to specify the entire model. I do not like using commands that make automatic constraints for me – if you do, you are much more likely to make a mistake or not know what your model is doing.</p>
<div id="dgp" class="section level3">
<h3>DGP</h3>
<p>The underlying DGP will be the same throughout this exercise. Consistent with <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4259494/pdf/nihms412332.pdf">Ghisletta and McArdle, 2012</a>, we have:</p>
<p><span class="math display">\[\begin{equation}
y_t =  \alpha*b_1 + (1 + b_2)*y_{t-1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(b_1\)</span> is the constant change (similar to the “slope” term in a basic growth model, in latent change frameworks it is called the “change factor”) and <span class="math inline">\(b_2\)</span> is the proportion change, or the change from point to point. The values specified in the DGP are</p>
<p><span class="math display">\[\begin{equation}
y_t = 1*0.3 + (1 + -0.4)*y_{t-1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(b_1\)</span> is equal to 0.3 and <span class="math inline">\(b_2\)</span> is equal to -0.4. Let’s generate data for 500 people across six time points.</p>
<pre class="r"><code>constant &lt;- 0.3
proportion &lt;- -0.4

people &lt;- 500
time &lt;- 6

df &lt;- matrix(, nrow = people*time, ncol = 3)
count &lt;- 0

for(i in 1:people){
  
  y_het &lt;- rnorm(1, 0, 2)
  
  for(j in 1:time){
    count &lt;- count + 1
    
    if(j == 1){
      df[count, 1] &lt;- i
      df[count, 2] &lt;- j
      df[count, 3] &lt;- y_het + rnorm(1,0,1)
    }else{
      df[count, 1] &lt;- i
      df[count, 2] &lt;- j
      df[count, 3] &lt;- 1*constant + (1+proportion)*df[count - 1, 3] + y_het + rnorm(1,0,1)
    }
    
    
    
  }
  
  
  
}

df &lt;- data.frame(df)
names(df) &lt;- c(&#39;id&#39;, &#39;time&#39;, &#39;y&#39;)
random_ids &lt;- sample(1:people, 5)
sample_df &lt;- df %&gt;%
  filter(id %in% random_ids)

ggplot(df, aes(x = time, y = y, group = id)) + 
  geom_point(color = &#39;grey85&#39;) + 
  geom_line(color = &#39;grey85&#39;) + 
  geom_point(data = sample_df, aes(x = time, y = y, group = id)) + 
  geom_line(data = sample_df, aes(x = time, y = y, group = id))</code></pre>
<p><img src="/Computational_Notes/2020-08-09/index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Change the data to wide and load <code>lavaan</code> before we start modeling.</p>
<pre class="r"><code>df_wide &lt;- reshape(df, idvar = &#39;id&#39;, timevar = &#39;time&#39;, direction = &#39;wide&#39;)
library(lavaan)</code></pre>
</div>
<div id="intercept-only-model" class="section level1">
<h1>Intercept Only Model</h1>
<p>Similar to the intercept-only model in a “non-latent change” framework (i.e., a simple growth model), the intercept-only model here contains a latent variable over the first observation.</p>
<p><img src="https://github.com/Cdishop/website/raw/master/content/Computational_Notes/dual_change_photos/1.png" /></p>
<p>There are six observations of <span class="math inline">\(y\)</span> and each is predicted by its latent “true score.” The first true score term is regressed on a latent intercept. The other true scores are regressed on additional latent variables that represent latent change. We don’t have anything relating to those latent change score terms yet so they don’t do much in this model. The autoregressive paths from true score to true score are constrained to 1. Here is how we estimate it.</p>
<pre class="r"><code>int_only_string &lt;- &#39;

# latent true scores over the observed y points
l_y1 =~ 1*y.1
l_y2 =~ 1*y.2
l_y3 =~ 1*y.3
l_y4 =~ 1*y.4
l_y5 =~ 1*y.5
l_y6 =~ 1*y.6

# latent change scores over the latent true scores
# y1 does not get one because it is the first time point
lc_y2 =~ 1*l_y2
lc_y3 =~ 1*l_y3
lc_y4 =~ 1*l_y4
lc_y5 =~ 1*l_y5
lc_y6 =~ 1*l_y6

# autoregression of the latent true scores
l_y2 ~ 1*l_y1
l_y3 ~ 1*l_y2
l_y4 ~ 1*l_y3
l_y5 ~ 1*l_y4
l_y6 ~ 1*l_y5

# latent intercept over the first true score of y
latent_intercept =~ 1*l_y1

# estimate mean and variance of latent intercept
latent_intercept ~~ latent_intercept
latent_intercept ~ 1

# means and variances of latent factors set to zero

l_y1 ~ 0
l_y2 ~ 0
l_y3 ~ 0
l_y4 ~ 0
l_y5 ~ 0
l_y6 ~ 0

l_y1 ~~ 0*l_y1
l_y2 ~~ 0*l_y2
l_y3 ~~ 0*l_y3
l_y4 ~~ 0*l_y4
l_y5 ~~ 0*l_y5
l_y6 ~~ 0*l_y6

lc_y2 ~ 0
lc_y3 ~ 0
lc_y4 ~ 0
lc_y5 ~ 0
lc_y6 ~ 0

lc_y2 ~~ 0*lc_y2
lc_y3 ~~ 0*lc_y3
lc_y4 ~~ 0*lc_y4
lc_y5 ~~ 0*lc_y5
lc_y6 ~~ 0*lc_y6

# means of indicators set to zero

y.1 ~ 0
y.2 ~ 0
y.3 ~ 0
y.4 ~ 0
y.5 ~ 0
y.6 ~ 0

# residual variances constrained to be equal across time

y.1 ~~ res_var*y.1
y.2 ~~ res_var*y.2
y.3 ~~ res_var*y.3
y.4 ~~ res_var*y.4
y.5 ~~ res_var*y.5
y.6 ~~ res_var*y.6

# Constrain latent change factors to not correlate with each other

lc_y2 ~~ 0*lc_y3 + 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y3 ~~ 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y4 ~~ 0*lc_y5 + 0*lc_y6
lc_y5 ~~ 0*lc_y6

# constrain latent intercept not to correlate with the change factors
latent_intercept ~~ 0*lc_y2 + 0*lc_y3 + 0*lc_y4 + 0*lc_y5 + 0*lc_y6

&#39;

int_only_model &lt;- sem(int_only_string, data = df_wide)
summary(int_only_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 28 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                          8
##   Number of equality constraints                     5
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                              2464.019
##   Degrees of freedom                                24
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              6402.982
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.618
##   Tucker-Lewis Index (TLI)                       0.761
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -6355.181
##   Loglikelihood unrestricted model (H1)      -5123.171
##                                                       
##   Akaike (AIC)                               12716.361
##   Bayesian (BIC)                             12729.005
##   Sample-size adjusted Bayesian (BIC)        12719.483
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.451
##   90 Percent confidence interval - lower         0.436
##   90 Percent confidence interval - upper         0.466
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.601
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y1 =~                                                
##     y.1                  1.000                           
##   l_y2 =~                                                
##     y.2                  1.000                           
##   l_y3 =~                                                
##     y.3                  1.000                           
##   l_y4 =~                                                
##     y.4                  1.000                           
##   l_y5 =~                                                
##     y.5                  1.000                           
##   l_y6 =~                                                
##     y.6                  1.000                           
##   lc_y2 =~                                               
##     l_y2                 1.000                           
##   lc_y3 =~                                               
##     l_y3                 1.000                           
##   lc_y4 =~                                               
##     l_y4                 1.000                           
##   lc_y5 =~                                               
##     l_y5                 1.000                           
##   lc_y6 =~                                               
##     l_y6                 1.000                           
##   latent_intercept =~                                    
##     l_y1                 1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y2 ~                                              
##     l_y1              1.000                           
##   l_y3 ~                                              
##     l_y2              1.000                           
##   l_y4 ~                                              
##     l_y3              1.000                           
##   l_y5 ~                                              
##     l_y4              1.000                           
##   l_y6 ~                                              
##     l_y5              1.000                           
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   lc_y2 ~~                                            
##     lc_y3             0.000                           
##     lc_y4             0.000                           
##     lc_y5             0.000                           
##     lc_y6             0.000                           
##   lc_y3 ~~                                            
##     lc_y4             0.000                           
##     lc_y5             0.000                           
##     lc_y6             0.000                           
##   lc_y4 ~~                                            
##     lc_y5             0.000                           
##     lc_y6             0.000                           
##   lc_y5 ~~                                            
##     lc_y6             0.000                           
##   lc_y2 ~~                                            
##     latent_intrcpt    0.000                           
##   lc_y3 ~~                                            
##     latent_intrcpt    0.000                           
##   lc_y4 ~~                                            
##     latent_intrcpt    0.000                           
##   lc_y5 ~~                                            
##     latent_intrcpt    0.000                           
##   lc_y6 ~~                                            
##     latent_intrcpt    0.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     latent_intrcpt    0.293    0.175    1.676    0.094
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##     lc_y2             0.000                           
##     lc_y3             0.000                           
##     lc_y4             0.000                           
##     lc_y5             0.000                           
##     lc_y6             0.000                           
##    .y.1               0.000                           
##    .y.2               0.000                           
##    .y.3               0.000                           
##    .y.4               0.000                           
##    .y.5               0.000                           
##    .y.6               0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     ltnt_nt          14.948    0.968   15.437    0.000
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##     lc_y2             0.000                           
##     lc_y3             0.000                           
##     lc_y4             0.000                           
##     lc_y5             0.000                           
##     lc_y6             0.000                           
##    .y.1     (rs_v)    2.170    0.061   35.355    0.000
##    .y.2     (rs_v)    2.170    0.061   35.355    0.000
##    .y.3     (rs_v)    2.170    0.061   35.355    0.000
##    .y.4     (rs_v)    2.170    0.061   35.355    0.000
##    .y.5     (rs_v)    2.170    0.061   35.355    0.000
##    .y.6     (rs_v)    2.170    0.061   35.355    0.000</code></pre>
</div>
<div id="proportion-change-model" class="section level1">
<h1>Proportion Change Model</h1>
<p>Now we include the proportion change along with the latent intercept.</p>
<p><img src="https://github.com/Cdishop/website/raw/master/content/Computational_Notes/dual_change_photos/2.png" /></p>
<pre class="r"><code>proportion_string &lt;- &#39;

# latent true scores over the observed y points
l_y1 =~ 1*y.1
l_y2 =~ 1*y.2
l_y3 =~ 1*y.3
l_y4 =~ 1*y.4
l_y5 =~ 1*y.5
l_y6 =~ 1*y.6

# latent change scores over the latent true scores
# y1 does not get one because it is the first time point
lc_y2 =~ 1*l_y2
lc_y3 =~ 1*l_y3
lc_y4 =~ 1*l_y4
lc_y5 =~ 1*l_y5
lc_y6 =~ 1*l_y6

# autoregression of the latent true scores
l_y2 ~ 1*l_y1
l_y3 ~ 1*l_y2
l_y4 ~ 1*l_y3
l_y5 ~ 1*l_y4
l_y6 ~ 1*l_y5

# latent intercept over the first true score of y
latent_intercept =~ 1*l_y1

# estimate mean and variance of latent intercept
latent_intercept ~~ latent_intercept
latent_intercept ~ 1

# HERE IS THE CHANGE
# proportion parameter estimate (estimate of b2)
# regress latent change on latent true score from the last time point
lc_y2 ~ b2*l_y1
lc_y3 ~ b2*l_y2
lc_y4 ~ b2*l_y3
lc_y5 ~ b2*l_y4
lc_y6 ~ b2*l_y5

# means and variances of latent factors set to zero

l_y1 ~ 0
l_y2 ~ 0
l_y3 ~ 0
l_y4 ~ 0
l_y5 ~ 0
l_y6 ~ 0

l_y1 ~~ 0*l_y1
l_y2 ~~ 0*l_y2
l_y3 ~~ 0*l_y3
l_y4 ~~ 0*l_y4
l_y5 ~~ 0*l_y5
l_y6 ~~ 0*l_y6

lc_y2 ~ 0
lc_y3 ~ 0
lc_y4 ~ 0
lc_y5 ~ 0
lc_y6 ~ 0

lc_y2 ~~ 0*lc_y2
lc_y3 ~~ 0*lc_y3
lc_y4 ~~ 0*lc_y4
lc_y5 ~~ 0*lc_y5
lc_y6 ~~ 0*lc_y6

# means of indicators set to zero

y.1 ~ 0
y.2 ~ 0
y.3 ~ 0
y.4 ~ 0
y.5 ~ 0
y.6 ~ 0

# residual variances constrained to be equal across time

y.1 ~~ res_var*y.1
y.2 ~~ res_var*y.2
y.3 ~~ res_var*y.3
y.4 ~~ res_var*y.4
y.5 ~~ res_var*y.5
y.6 ~~ res_var*y.6

# Constrain latent change factors to not correlate with each other

lc_y2 ~~ 0*lc_y3 + 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y3 ~~ 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y4 ~~ 0*lc_y5 + 0*lc_y6
lc_y5 ~~ 0*lc_y6

# constrain latent intercept not to correlate with the change factors
latent_intercept ~~ 0*lc_y2 + 0*lc_y3 + 0*lc_y4 + 0*lc_y5 + 0*lc_y6

&#39;

proportion_model &lt;- sem(proportion_string, data = df_wide)
summary(proportion_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 20 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         13
##   Number of equality constraints                     9
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                               949.368
##   Degrees of freedom                                23
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              6402.982
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.855
##   Tucker-Lewis Index (TLI)                       0.905
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -5597.855
##   Loglikelihood unrestricted model (H1)      -5123.171
##                                                       
##   Akaike (AIC)                               11203.710
##   Bayesian (BIC)                             11220.569
##   Sample-size adjusted Bayesian (BIC)        11207.872
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.284
##   90 Percent confidence interval - lower         0.269
##   90 Percent confidence interval - upper         0.299
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.214
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y1 =~                                                
##     y.1                  1.000                           
##   l_y2 =~                                                
##     y.2                  1.000                           
##   l_y3 =~                                                
##     y.3                  1.000                           
##   l_y4 =~                                                
##     y.4                  1.000                           
##   l_y5 =~                                                
##     y.5                  1.000                           
##   l_y6 =~                                                
##     y.6                  1.000                           
##   lc_y2 =~                                               
##     l_y2                 1.000                           
##   lc_y3 =~                                               
##     l_y3                 1.000                           
##   lc_y4 =~                                               
##     l_y4                 1.000                           
##   lc_y5 =~                                               
##     l_y5                 1.000                           
##   lc_y6 =~                                               
##     l_y6                 1.000                           
##   latent_intercept =~                                    
##     l_y1                 1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y2 ~                                              
##     l_y1              1.000                           
##   l_y3 ~                                              
##     l_y2              1.000                           
##   l_y4 ~                                              
##     l_y3              1.000                           
##   l_y5 ~                                              
##     l_y4              1.000                           
##   l_y6 ~                                              
##     l_y5              1.000                           
##   lc_y2 ~                                             
##     l_y1      (b2)    0.141    0.004   39.913    0.000
##   lc_y3 ~                                             
##     l_y2      (b2)    0.141    0.004   39.913    0.000
##   lc_y4 ~                                             
##     l_y3      (b2)    0.141    0.004   39.913    0.000
##   lc_y5 ~                                             
##     l_y4      (b2)    0.141    0.004   39.913    0.000
##   lc_y6 ~                                             
##     l_y5      (b2)    0.141    0.004   39.913    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##  .lc_y2 ~~                                            
##    .lc_y3             0.000                           
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##  .lc_y3 ~~                                            
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##  .lc_y4 ~~                                            
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##  .lc_y5 ~~                                            
##    .lc_y6             0.000                           
##  .lc_y2 ~~                                            
##     latent_intrcpt    0.000                           
##  .lc_y3 ~~                                            
##     latent_intrcpt    0.000                           
##  .lc_y4 ~~                                            
##     latent_intrcpt    0.000                           
##  .lc_y5 ~~                                            
##     latent_intrcpt    0.000                           
##  .lc_y6 ~~                                            
##     latent_intrcpt    0.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     latent_intrcpt    0.220    0.123    1.791    0.073
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##    .lc_y2             0.000                           
##    .lc_y3             0.000                           
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##    .y.1               0.000                           
##    .y.2               0.000                           
##    .y.3               0.000                           
##    .y.4               0.000                           
##    .y.5               0.000                           
##    .y.6               0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     ltnt_nt           7.462    0.501   14.907    0.000
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##    .lc_y2             0.000                           
##    .lc_y3             0.000                           
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##    .y.1     (rs_v)    1.172    0.033   35.355    0.000
##    .y.2     (rs_v)    1.172    0.033   35.355    0.000
##    .y.3     (rs_v)    1.172    0.033   35.355    0.000
##    .y.4     (rs_v)    1.172    0.033   35.355    0.000
##    .y.5     (rs_v)    1.172    0.033   35.355    0.000
##    .y.6     (rs_v)    1.172    0.033   35.355    0.000</code></pre>
</div>
<div id="latent-constant-change" class="section level1">
<h1>Latent Constant Change</h1>
<p>This model is nearly identical to the basic linear growth curve model, it simply embodies it in the latent change framework. The basis coefficients from the constant change term to the latent change scores are constrained to one, then we estimate the mean of the constant change.</p>
<p><img src="https://github.com/Cdishop/website/raw/master/content/Computational_Notes/dual_change_photos/3.png" /></p>
<pre class="r"><code>constant_change_string &lt;- &#39;

# latent true scores over the observed y points
l_y1 =~ 1*y.1
l_y2 =~ 1*y.2
l_y3 =~ 1*y.3
l_y4 =~ 1*y.4
l_y5 =~ 1*y.5
l_y6 =~ 1*y.6

# latent change scores over the latent true scores
# y1 does not get one because it is the first time point
lc_y2 =~ 1*l_y2
lc_y3 =~ 1*l_y3
lc_y4 =~ 1*l_y4
lc_y5 =~ 1*l_y5
lc_y6 =~ 1*l_y6

# autoregression of the latent true scores (the first level latent variables)
l_y2 ~ 1*l_y1
l_y3 ~ 1*l_y2
l_y4 ~ 1*l_y3
l_y5 ~ 1*l_y4
l_y6 ~ 1*l_y5

# latent intercept over the first true score of y
latent_intercept =~ 1*l_y1

# HERE IS THE CHANGE

# latent slope over the change scores
# this is called the change factor in dual change terminology...it is not really a slope term. It is the constant change factor
latent_slope =~ 1*lc_y2 + 1*lc_y3 + 1*lc_y4 + 1*lc_y5 + 1*lc_y6

# estimate covariance between latent intercept and slope (change factor)

latent_intercept ~~ latent_slope

# estimate mean and variance of intercept and slope (change factor)

latent_intercept ~~ latent_intercept
latent_slope ~~ latent_slope

latent_intercept ~ 1
latent_slope ~ 1

# means and variances of latent factors set to zero

l_y1 ~ 0
l_y2 ~ 0
l_y3 ~ 0
l_y4 ~ 0
l_y5 ~ 0
l_y6 ~ 0

l_y1 ~~ 0*l_y1
l_y2 ~~ 0*l_y2
l_y3 ~~ 0*l_y3
l_y4 ~~ 0*l_y4
l_y5 ~~ 0*l_y5
l_y6 ~~ 0*l_y6

lc_y2 ~ 0
lc_y3 ~ 0
lc_y4 ~ 0
lc_y5 ~ 0
lc_y6 ~ 0

lc_y2 ~~ 0*lc_y2
lc_y3 ~~ 0*lc_y3
lc_y4 ~~ 0*lc_y4
lc_y5 ~~ 0*lc_y5
lc_y6 ~~ 0*lc_y6

# means of indicators set to zero

y.1 ~ 0
y.2 ~ 0
y.3 ~ 0
y.4 ~ 0
y.5 ~ 0
y.6 ~ 0

# residual variances constrained to be equal across time

y.1 ~~ res_var*y.1
y.2 ~~ res_var*y.2
y.3 ~~ res_var*y.3
y.4 ~~ res_var*y.4
y.5 ~~ res_var*y.5
y.6 ~~ res_var*y.6

# Constrain latent change factors to not correlate with each other

lc_y2 ~~ 0*lc_y3 + 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y3 ~~ 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y4 ~~ 0*lc_y5 + 0*lc_y6
lc_y5 ~~ 0*lc_y6

# constrain latent intercept not to correlate with the change factors
latent_intercept ~~ 0*lc_y2 + 0*lc_y3 + 0*lc_y4 + 0*lc_y5 + 0*lc_y6

&#39;

constant_change_model &lt;- sem(constant_change_string, data = df_wide)
summary(constant_change_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 35 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         11
##   Number of equality constraints                     5
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                               657.980
##   Degrees of freedom                                21
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              6402.982
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.900
##   Tucker-Lewis Index (TLI)                       0.929
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -5452.161
##   Loglikelihood unrestricted model (H1)      -5123.171
##                                                       
##   Akaike (AIC)                               10916.322
##   Bayesian (BIC)                             10941.610
##   Sample-size adjusted Bayesian (BIC)        10922.565
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.246
##   90 Percent confidence interval - lower         0.230
##   90 Percent confidence interval - upper         0.263
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.159
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y1 =~                                                
##     y.1                  1.000                           
##   l_y2 =~                                                
##     y.2                  1.000                           
##   l_y3 =~                                                
##     y.3                  1.000                           
##   l_y4 =~                                                
##     y.4                  1.000                           
##   l_y5 =~                                                
##     y.5                  1.000                           
##   l_y6 =~                                                
##     y.6                  1.000                           
##   lc_y2 =~                                               
##     l_y2                 1.000                           
##   lc_y3 =~                                               
##     l_y3                 1.000                           
##   lc_y4 =~                                               
##     l_y4                 1.000                           
##   lc_y5 =~                                               
##     l_y5                 1.000                           
##   lc_y6 =~                                               
##     l_y6                 1.000                           
##   latent_intercept =~                                    
##     l_y1                 1.000                           
##   latent_slope =~                                        
##     lc_y2                1.000                           
##     lc_y3                1.000                           
##     lc_y4                1.000                           
##     lc_y5                1.000                           
##     lc_y6                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y2 ~                                              
##     l_y1              1.000                           
##   l_y3 ~                                              
##     l_y2              1.000                           
##   l_y4 ~                                              
##     l_y3              1.000                           
##   l_y5 ~                                              
##     l_y4              1.000                           
##   l_y6 ~                                              
##     l_y5              1.000                           
## 
## Covariances:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   latent_intercept ~~                                    
##     latent_slope         1.271    0.091   13.962    0.000
##  .lc_y2 ~~                                               
##    .lc_y3                0.000                           
##    .lc_y4                0.000                           
##    .lc_y5                0.000                           
##    .lc_y6                0.000                           
##  .lc_y3 ~~                                               
##    .lc_y4                0.000                           
##    .lc_y5                0.000                           
##    .lc_y6                0.000                           
##  .lc_y4 ~~                                               
##    .lc_y5                0.000                           
##    .lc_y6                0.000                           
##  .lc_y5 ~~                                               
##    .lc_y6                0.000                           
##  .lc_y2 ~~                                               
##     latent_intrcpt       0.000                           
##  .lc_y3 ~~                                               
##     latent_intrcpt       0.000                           
##  .lc_y4 ~~                                               
##     latent_intrcpt       0.000                           
##  .lc_y5 ~~                                               
##     latent_intrcpt       0.000                           
##  .lc_y6 ~~                                               
##     latent_intrcpt       0.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     latent_intrcpt    0.044    0.119    0.371    0.710
##     latent_slope      0.100    0.028    3.527    0.000
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##    .lc_y2             0.000                           
##    .lc_y3             0.000                           
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##    .y.1               0.000                           
##    .y.2               0.000                           
##    .y.3               0.000                           
##    .y.4               0.000                           
##    .y.5               0.000                           
##    .y.6               0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     ltnt_nt           6.641    0.451   14.726    0.000
##     ltnt_sl           0.345    0.025   13.680    0.000
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##    .lc_y2             0.000                           
##    .lc_y3             0.000                           
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##    .y.1     (rs_v)    0.926    0.029   31.623    0.000
##    .y.2     (rs_v)    0.926    0.029   31.623    0.000
##    .y.3     (rs_v)    0.926    0.029   31.623    0.000
##    .y.4     (rs_v)    0.926    0.029   31.623    0.000
##    .y.5     (rs_v)    0.926    0.029   31.623    0.000
##    .y.6     (rs_v)    0.926    0.029   31.623    0.000</code></pre>
</div>
<div id="dual-change-model" class="section level1">
<h1>Dual Change Model</h1>
<p>Now a full dual change model with both constant and proportion change parameters.</p>
<p><img src="https://github.com/Cdishop/website/raw/master/content/Computational_Notes/dual_change_photos/4.png" /></p>
<pre class="r"><code>dual_c_string &lt;- &#39;

# latent true scores over the observed y points
l_y1 =~ 1*y.1
l_y2 =~ 1*y.2
l_y3 =~ 1*y.3
l_y4 =~ 1*y.4
l_y5 =~ 1*y.5
l_y6 =~ 1*y.6

# latent change scores over the latent true scores
# y1 does not get one because it is the first time point
lc_y2 =~ 1*l_y2
lc_y3 =~ 1*l_y3
lc_y4 =~ 1*l_y4
lc_y5 =~ 1*l_y5
lc_y6 =~ 1*l_y6

# autoregression of the latent true scores (the first level latent variables)
l_y2 ~ 1*l_y1
l_y3 ~ 1*l_y2
l_y4 ~ 1*l_y3
l_y5 ~ 1*l_y4
l_y6 ~ 1*l_y5

# latent intercept over the first true score of y
latent_intercept =~ 1*l_y1

# CHANGE 1 OF THE DUAL CHANGE MODEL

# latent slope over the change scores
# this is called the change factor in dual change terminology...it is not really a slope term. It is the constant change factor
latent_slope =~ 1*lc_y2 + 1*lc_y3 + 1*lc_y4 + 1*lc_y5 + 1*lc_y6

# estimate covariance between latent intercept and slope (change factor)

latent_intercept ~~ latent_slope

# estimate mean and variance of intercept and slope (change factor)

latent_intercept ~~ latent_intercept
latent_slope ~~ latent_slope

latent_intercept ~ 1
latent_slope ~ 1

# CHANGE 2 OF THE DUAL CHANGE MODEL

# autoproportion change. Relationship between true score and latent change score at next time point
# these are estimated
lc_y2 ~ b*l_y1
lc_y3 ~ b*l_y2
lc_y4 ~ b*l_y3
lc_y5 ~ b*l_y4
lc_y6 ~ b*l_y5

# means and variances of latent factors set to zero

l_y1 ~ 0
l_y2 ~ 0
l_y3 ~ 0
l_y4 ~ 0
l_y5 ~ 0
l_y6 ~ 0

l_y1 ~~ 0*l_y1
l_y2 ~~ 0*l_y2
l_y3 ~~ 0*l_y3
l_y4 ~~ 0*l_y4
l_y5 ~~ 0*l_y5
l_y6 ~~ 0*l_y6

lc_y2 ~ 0
lc_y3 ~ 0
lc_y4 ~ 0
lc_y5 ~ 0
lc_y6 ~ 0

lc_y2 ~~ 0*lc_y2
lc_y3 ~~ 0*lc_y3
lc_y4 ~~ 0*lc_y4
lc_y5 ~~ 0*lc_y5
lc_y6 ~~ 0*lc_y6

# means of indicators set to zero

y.1 ~ 0
y.2 ~ 0
y.3 ~ 0
y.4 ~ 0
y.5 ~ 0
y.6 ~ 0

# residual variances constrained to be equal across time

y.1 ~~ res_var*y.1
y.2 ~~ res_var*y.2
y.3 ~~ res_var*y.3
y.4 ~~ res_var*y.4
y.5 ~~ res_var*y.5
y.6 ~~ res_var*y.6

# Constrain latent change factors to not correlate with each other

lc_y2 ~~ 0*lc_y3 + 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y3 ~~ 0*lc_y4 + 0*lc_y5 + 0*lc_y6
lc_y4 ~~ 0*lc_y5 + 0*lc_y6
lc_y5 ~~ 0*lc_y6


&#39;

dual_change_model &lt;- sem(dual_c_string, data = df_wide)
summary(dual_change_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 45 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         16
##   Number of equality constraints                     9
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                               267.497
##   Degrees of freedom                                20
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              6402.982
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.961
##   Tucker-Lewis Index (TLI)                       0.971
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -5256.919
##   Loglikelihood unrestricted model (H1)      -5123.171
##                                                       
##   Akaike (AIC)                               10527.839
##   Bayesian (BIC)                             10557.341
##   Sample-size adjusted Bayesian (BIC)        10535.123
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.157
##   90 Percent confidence interval - lower         0.141
##   90 Percent confidence interval - upper         0.174
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.024
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y1 =~                                                
##     y.1                  1.000                           
##   l_y2 =~                                                
##     y.2                  1.000                           
##   l_y3 =~                                                
##     y.3                  1.000                           
##   l_y4 =~                                                
##     y.4                  1.000                           
##   l_y5 =~                                                
##     y.5                  1.000                           
##   l_y6 =~                                                
##     y.6                  1.000                           
##   lc_y2 =~                                               
##     l_y2                 1.000                           
##   lc_y3 =~                                               
##     l_y3                 1.000                           
##   lc_y4 =~                                               
##     l_y4                 1.000                           
##   lc_y5 =~                                               
##     l_y5                 1.000                           
##   lc_y6 =~                                               
##     l_y6                 1.000                           
##   latent_intercept =~                                    
##     l_y1                 1.000                           
##   latent_slope =~                                        
##     lc_y2                1.000                           
##     lc_y3                1.000                           
##     lc_y4                1.000                           
##     lc_y5                1.000                           
##     lc_y6                1.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   l_y2 ~                                              
##     l_y1              1.000                           
##   l_y3 ~                                              
##     l_y2              1.000                           
##   l_y4 ~                                              
##     l_y3              1.000                           
##   l_y5 ~                                              
##     l_y4              1.000                           
##   l_y6 ~                                              
##     l_y5              1.000                           
##   lc_y2 ~                                             
##     l_y1       (b)   -0.378    0.016  -23.497    0.000
##   lc_y3 ~                                             
##     l_y2       (b)   -0.378    0.016  -23.497    0.000
##   lc_y4 ~                                             
##     l_y3       (b)   -0.378    0.016  -23.497    0.000
##   lc_y5 ~                                             
##     l_y4       (b)   -0.378    0.016  -23.497    0.000
##   lc_y6 ~                                             
##     l_y5       (b)   -0.378    0.016  -23.497    0.000
## 
## Covariances:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   latent_intercept ~~                                    
##     latent_slope         3.898    0.279   13.948    0.000
##  .lc_y2 ~~                                               
##    .lc_y3                0.000                           
##    .lc_y4                0.000                           
##    .lc_y5                0.000                           
##    .lc_y6                0.000                           
##  .lc_y3 ~~                                               
##    .lc_y4                0.000                           
##    .lc_y5                0.000                           
##    .lc_y6                0.000                           
##  .lc_y4 ~~                                               
##    .lc_y5                0.000                           
##    .lc_y6                0.000                           
##  .lc_y5 ~~                                               
##    .lc_y6                0.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     latent_intrcpt   -0.046    0.102   -0.457    0.648
##     latent_slope      0.202    0.089    2.263    0.024
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##    .lc_y2             0.000                           
##    .lc_y3             0.000                           
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##    .y.1               0.000                           
##    .y.2               0.000                           
##    .y.3               0.000                           
##    .y.4               0.000                           
##    .y.5               0.000                           
##    .y.6               0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     ltnt_nt           4.563    0.332   13.755    0.000
##     ltnt_sl           3.927    0.346   11.345    0.000
##    .l_y1              0.000                           
##    .l_y2              0.000                           
##    .l_y3              0.000                           
##    .l_y4              0.000                           
##    .l_y5              0.000                           
##    .l_y6              0.000                           
##    .lc_y2             0.000                           
##    .lc_y3             0.000                           
##    .lc_y4             0.000                           
##    .lc_y5             0.000                           
##    .lc_y6             0.000                           
##    .y.1     (rs_v)    0.784    0.025   31.623    0.000
##    .y.2     (rs_v)    0.784    0.025   31.623    0.000
##    .y.3     (rs_v)    0.784    0.025   31.623    0.000
##    .y.4     (rs_v)    0.784    0.025   31.623    0.000
##    .y.5     (rs_v)    0.784    0.025   31.623    0.000
##    .y.6     (rs_v)    0.784    0.025   31.623    0.000</code></pre>
<p>The estimate of the constant change (called “latent slope” in my string syntax; <span class="math inline">\(b_1\)</span>) is close to 0.3 and the estimate of the proportion change (<span class="math inline">\(b_2\)</span>) is close to -0.4. Not bad.</p>
<div id="a-note-on-interpreting" class="section level2">
<h2>A Note On Interpreting</h2>
<p>These models predict complex change patterns. It is difficult to know the expected curvilinear pattern that the models expect without computing expected scores and plotting them. I did not do that here.</p>
<p>Bo<span class="math inline">\(^2\)</span>m =)</p>
</div>
</div>
