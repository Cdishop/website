<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="-----">

  
  <link rel="alternate" hreflang="en-us" href="/computational_notes/2018-08-12/">

  


  
  
  
  <meta name="theme-color" content="#06805E">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/tomorrow.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/tomorrow.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,400i%7CKarla:400,400i,700,700i%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99209585-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-99209585-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hua7ddb50eead73fc737c5c3187aff8cf9_17132_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua7ddb50eead73fc737c5c3187aff8cf9_17132_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/computational_notes/2018-08-12/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@apreshill">
  <meta property="twitter:creator" content="@apreshill">
  
  <meta property="og:site_name" content="Christopher R. Dishop">
  <meta property="og:url" content="/computational_notes/2018-08-12/">
  <meta property="og:title" content="Monte Carlo Approximation | Christopher R. Dishop">
  <meta property="og:description" content="-----"><meta property="og:image" content="/img/pom-card.png">
  <meta property="twitter:image" content="/img/pom-card.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2018-08-12T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2018-08-12T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Monte Carlo Approximation | Christopher R. Dishop</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Christopher R. Dishop</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://raw.githubusercontent.com/Cdishop/website/master/misc/CV.pdf" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/computational_notes"><span>Computation</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/r_resources"><span>R Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/rec_reading"><span>Recommended</span></a>
        </li>

        
        

      

        

        

        

        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Monte Carlo Approximation</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Aug 12, 2018
  </span>
  

  

  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>Monte Carlo helps us understand processes that we can describe but don’t yet have analytic solutions for. Here are two examples: the birthday problem and the tasting tea problem.</p>
<div id="birthday-problem" class="section level1">
<h1>Birthday Problem</h1>
<p>If you are standing in a room with 25 other people, what is the probability that at least two people share the same birthday? This question has a mathematical solution, but if we don’t know it we can use Monte Carlo to help.</p>
<p>Select 25 people with random birthdays</p>
<pre class="r"><code>group_birthdays &lt;- sample(1:365, 15, replace = TRUE)</code></pre>
<p>and then check whether two of them share a birthday.</p>
<pre class="r"><code>shared_birthday &lt;- length(group_birthdays[duplicated(group_birthdays)])

# Returns 1 if yes and 0 if no</code></pre>
<p>Now place everything into a loop and evaluate 5000 times for the final Monte Carlo:</p>
<pre class="r"><code>group_size &lt;- 15
iterations &lt;- 5000
shared_birthdays_counter &lt;- 0

for(i in 1:iterations){
  
  
  group_birthdays &lt;- sample(1:365, 15, replace = TRUE)
  
  shared_birthday &lt;- length(group_birthdays[duplicated(group_birthdays)])
  
  if(shared_birthday == 1){
    
    shared_birthdays_counter &lt;- shared_birthdays_counter + 1
  }
  
  
  
}</code></pre>
<p>The probability of a shared birthday among a group of 15 is…</p>
<pre class="r"><code>shared_birthdays_counter / iterations</code></pre>
<pre><code>## [1] 0.2278</code></pre>
<p>The probability of a shared birthday as we increase group size…</p>
<pre class="r"><code>sizes &lt;- 2:25
prob_store &lt;- numeric(length(sizes))

for(j in 1:24){
  
  


group_size &lt;- j
iterations &lt;- 5000
shared_birthdays_counter &lt;- 0

for(i in 1:iterations){
  
  
  group_birthdays &lt;- sample(1:365, group_size, replace = TRUE)
  
  shared_birthday &lt;- length(group_birthdays[duplicated(group_birthdays)])
  
  if(shared_birthday == 1){
    
    shared_birthdays_counter &lt;- shared_birthdays_counter + 1
  }
  
  
  
}

prob_store[j] &lt;- shared_birthdays_counter / iterations

}

df &lt;- data.frame(
  &#39;group_size&#39; = c(2:25),
  &#39;probability&#39; = c(prob_store)
)

library(ggplot2)

plot1 &lt;- ggplot(df, aes(x = group_size, y = probability)) + 
  geom_bar(stat = &#39;identity&#39;, color = &#39;orange&#39;)

plot1</code></pre>
<p><img src="/Computational_Notes/2018-08-12/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The equation to solve the birthday problem is</p>
<p><span class="math display">\[\begin{equation}
n! / (n - k)!
\end{equation}\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of possible birthdays and <span class="math inline">\(k\)</span> is group size. The beauty of Monte Carlo is that we didn’t need the above equation to learn about our shared birthday process.</p>
</div>
<div id="tasting-tea" class="section level1">
<h1>Tasting Tea</h1>
<p>Imagine that I make one cup of tea with milk and then ask you the following: did I pour the tea or milk first? I repeat this for eight cups of tea. What is the probability that you guess correctly for 3 of the cups? For all 8 cups?</p>
<p>First, we generate truth. For each cup, ‘M’ means I poured milk first and ‘T’ means I poured tea first.</p>
<pre class="r"><code>possible_pours &lt;- c(rep(&#39;M&#39;, 4), rep(&#39;T&#39;, 4))
true_pours &lt;- sample(possible_pours, size = 8)

# The true first pours

true_pours</code></pre>
<pre><code>## [1] &quot;M&quot; &quot;M&quot; &quot;T&quot; &quot;T&quot; &quot;M&quot; &quot;T&quot; &quot;T&quot; &quot;M&quot;</code></pre>
<p>Then you make a guess for each cup.</p>
<pre class="r"><code>guess &lt;- c(&#39;M&#39;, &#39;T&#39;, &#39;T&#39;, &#39;M&#39;, &#39;T&#39;, &#39;T&#39;, &#39;M&#39;, &#39;M&#39;)</code></pre>
<p>In this case, you guessed that I poured milk first for cup 1 and tea first for cup 2. How many of your guesses are correct?</p>
<pre class="r"><code>correct &lt;- sum(true_pours == guess)

correct</code></pre>
<pre><code>## [1] 4</code></pre>
<p>Now we can put all of that into a Monte Carlo loop.</p>
<pre class="r"><code>iterations &lt;- 5000
correct_store &lt;- numeric(iterations)

for(i in 1:iterations){
  
  possible_pours &lt;- c(rep(&#39;M&#39;, 4), rep(&#39;T&#39;, 4))
  true_pours &lt;- sample(possible_pours, size = 8)
  
  guess &lt;- c(&#39;M&#39;, &#39;T&#39;, &#39;T&#39;, &#39;M&#39;, &#39;T&#39;, &#39;T&#39;, &#39;M&#39;, &#39;M&#39;)
  
  correct &lt;- sum(true_pours == guess)
  
  correct_store[i] &lt;- correct

  
}</code></pre>
<p>What is the probability of you guessing correctly for 2 cups…6?</p>
<pre class="r"><code>prop.table(table(correct_store))</code></pre>
<pre><code>## correct_store
##      0      2      4      6      8 
## 0.0144 0.2324 0.5022 0.2372 0.0138</code></pre>
<p>Just like the birthday problem, there are equations that govern this “tea problem.” We don’t know what they are, but we can still learn about the process by using Monte Carlo approximation.</p>
<p>These examples can be found with greater discussion in <em>Quantitative Social Science</em> by Kosuke Imai.</p>
<p>Bo<span class="math inline">\(^2\)</span>m =)</p>
</div>

    </div>

    
































  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.6f7ce8be710290b8c431bbc97f405d15.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">


  <p class="powered-by">
    © Christopher Dishop 2021 &middot; 

    Made with <a href="https://cran.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i> </a><a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a>,
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>, and
    <a href="https://github.com/rbind/apreshill" target="_blank" rel="noopener">Alison's Hill's</a> wonderful template. Views expressed on this website are my own. They do not reflect those of ARI, CUWMA, CRFP, nor of any person, member, or connected organization.

    

    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
