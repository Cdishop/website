<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">

    <meta name="author" content="Christopher R. Dishop">
    <meta name="description" content="Latent Growth Curves I will progress through three models: linear, quadratic growth, and latent basis. In every example I use a sample of 400, 6 time points, and ‘affect’ as the variable of interest.
Don’t forget that multiplying by time
 \(0.6t\)  is different from describing over time
 \(0.6_t\).  1) Linear The data generating process:
\[\begin{equation} y_{it} = 4 - 0.6t &#43; e_{t} \end{equation}\]
library(tidyverse) library(ggplot2) library(MASS) N &lt;- 400 time &lt;- 6 intercept &lt;- 4 linear_growth &lt;- -0.">
    <meta name="keywords" content="blog,developer,personal">

    
      <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>
    

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Latent Growth Curves"/>
<meta name="twitter:description" content="Latent Growth Curves I will progress through three models: linear, quadratic growth, and latent basis. In every example I use a sample of 400, 6 time points, and ‘affect’ as the variable of interest.
Don’t forget that multiplying by time
 \(0.6t\)  is different from describing over time
 \(0.6_t\).  1) Linear The data generating process:
\[\begin{equation} y_{it} = 4 - 0.6t &#43; e_{t} \end{equation}\]
library(tidyverse) library(ggplot2) library(MASS) N &lt;- 400 time &lt;- 6 intercept &lt;- 4 linear_growth &lt;- -0."/>

    <meta property="og:title" content="Latent Growth Curves" />
<meta property="og:description" content="Latent Growth Curves I will progress through three models: linear, quadratic growth, and latent basis. In every example I use a sample of 400, 6 time points, and ‘affect’ as the variable of interest.
Don’t forget that multiplying by time
 \(0.6t\)  is different from describing over time
 \(0.6_t\).  1) Linear The data generating process:
\[\begin{equation} y_{it} = 4 - 0.6t &#43; e_{t} \end{equation}\]
library(tidyverse) library(ggplot2) library(MASS) N &lt;- 400 time &lt;- 6 intercept &lt;- 4 linear_growth &lt;- -0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://christopherdishop.netlify.app/computational_notes/latent_growth/" />
<meta property="article:published_time" content="2018-04-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-04-15T00:00:00+00:00" />


    
      <base href="http://christopherdishop.netlify.app/computational_notes/latent_growth/">
    
    <title>
  Latent Growth Curves · Home
</title>

    
      <link rel="canonical" href="http://christopherdishop.netlify.app/computational_notes/latent_growth/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="http://christopherdishop.netlify.app/css/coder.min.aca465d1e362e89828cbd890adff660455d93a2703dbede119b5859a41672c49.css" integrity="sha256-rKRl0eNi6Jgoy9iQrf9mBFXZOicD2&#43;3hGbWFmkFnLEk=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    <link rel="icon" type="image/png" href="http://christopherdishop.netlify.app/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://christopherdishop.netlify.app/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.72.0" />
  </head>

  
  
  <body class="colorscheme-light"
        onload=" twemoji.parse(document.body); "
  >
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://christopherdishop.netlify.app/">
      Home
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://christopherdishop.netlify.app/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://raw.githubusercontent.com/Cdishop/homepage/master/misc/CV.pdf">CV</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://christopherdishop.netlify.app/Computational_Notes/">Computational Notes</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://christopherdishop.netlify.app/r_resources/">R Resources</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://christopherdishop.netlify.app/rec_reading/">Recommended Reading</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Latent Growth Curves</h1>
    </header>

    


<div id="latent-growth-curves" class="section level1">
<h1>Latent Growth Curves</h1>
<p>I will progress through three models: linear, quadratic growth, and latent basis. In every example I use a sample of 400, 6 time points, and ‘affect’ as the variable of interest.</p>
<p>Don’t forget that multiplying by time</p>
<ul>
<li><span class="math inline">\(0.6t\)</span></li>
</ul>
<p>is different from describing over time</p>
<ul>
<li><span class="math inline">\(0.6_t\)</span>.</li>
</ul>
<div id="linear" class="section level3">
<h3>1) Linear</h3>
<p><em>The data generating process:</em></p>
<p><span class="math display">\[\begin{equation}
y_{it} = 4 - 0.6t + e_{t}
\end{equation}\]</span></p>
<pre class="r"><code>library(tidyverse)
library(ggplot2)
library(MASS)

N &lt;- 400
time &lt;- 6

intercept &lt;- 4
linear_growth &lt;- -0.6

df_matrix &lt;- matrix(, nrow = N*time, ncol = 3)

count &lt;- 0

for(i in 1:400){
  
  unob_het_affect &lt;- rnorm(1,0,3)

  
  for(j in 1:6){
    
    count &lt;- count + 1
    
    if(j == 1){
      
      df_matrix[count, 1] &lt;- i
      df_matrix[count, 2] &lt;- j
      df_matrix[count, 3] &lt;- intercept + unob_het_affect + rnorm(1,0,1)
    }else{
      
      
      df_matrix[count, 1] &lt;- i
      df_matrix[count, 2] &lt;- j
      df_matrix[count, 3] &lt;- intercept + linear_growth*j + unob_het_affect + rnorm(1,0,1)
      
    }
    
    
    
  }
  
  
}

df &lt;- data.frame(df_matrix)
names(df) &lt;- c(&#39;id&#39;, &#39;time&#39;, &#39;affect&#39;)

random_ids &lt;- sample(df$id, 5)

random_df &lt;- df %&gt;%
  filter(id %in% random_ids)
  

ggplot(df, aes(x = time, y = affect, group = id)) + 
  geom_point(color = &#39;gray85&#39;) + 
  geom_line(color = &#39;gray85&#39;) + 
  geom_point(data = random_df, aes(x = time, y = affect, group = id), color = &#39;blue&#39;) + 
  geom_line(data = random_df, aes(x = time, y = affect, group = id), color = &#39;blue&#39;) + 
  theme_wsj()</code></pre>
<p><img src="http://christopherdishop.netlify.app/Computational_Notes/latent_growth_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p><em>Estimating the model:</em></p>
<p>Formatting the data:</p>
<pre class="r"><code>df_wide &lt;- reshape(df, idvar = &#39;id&#39;, timevar = &#39;time&#39;, direction = &#39;wide&#39;)</code></pre>
<p>First, an intercept only (no change) model:</p>
<pre class="r"><code>library(lavaan)

no_change_string &lt;- &#39;

# Latent intercept factor

intercept_affect =~ 1*affect.1 + 1*affect.2 + 1*affect.3 + 1*affect.4 + 1*affect.5 + 1*affect.6

# Mean and variance of latent intercept factor

intercept_affect ~~ intercept_affect

# Fix observed variable means to 0

affect.1 ~ 0
affect.2 ~ 0
affect.3 ~ 0
affect.4 ~ 0
affect.5 ~ 0
affect.6 ~ 0

# Constrain residual (error) variance of observed variables to equality across time

affect.1 ~~ res_var*affect.1
affect.2 ~~ res_var*affect.2
affect.3 ~~ res_var*affect.3
affect.4 ~~ res_var*affect.4
affect.5 ~~ res_var*affect.5
affect.6 ~~ res_var*affect.6


&#39;

no_change_model &lt;- growth(no_change_string, data = df_wide)
summary(no_change_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 19 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                          8
##   Number of equality constraints                     5
##                                                       
##   Number of observations                           400
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                              2048.324
##   Degrees of freedom                                24
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              3882.838
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.477
##   Tucker-Lewis Index (TLI)                       0.673
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -5218.978
##   Loglikelihood unrestricted model (H1)      -4194.816
##                                                       
##   Akaike (AIC)                               10443.956
##   Bayesian (BIC)                             10455.930
##   Sample-size adjusted Bayesian (BIC)        10446.411
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.459
##   90 Percent confidence interval - lower         0.442
##   90 Percent confidence interval - upper         0.476
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.198
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   intercept_affect =~                                    
##     affect.1             1.000                           
##     affect.2             1.000                           
##     affect.3             1.000                           
##     affect.4             1.000                           
##     affect.5             1.000                           
##     affect.6             1.000                           
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .affect.1          0.000                           
##    .affect.2          0.000                           
##    .affect.3          0.000                           
##    .affect.4          0.000                           
##    .affect.5          0.000                           
##    .affect.6          0.000                           
##     intercept_ffct    2.278    0.149   15.271    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     intrcp_           8.438    0.629   13.406    0.000
##    .affct.1 (rs_v)    2.768    0.088   31.623    0.000
##    .affct.2 (rs_v)    2.768    0.088   31.623    0.000
##    .affct.3 (rs_v)    2.768    0.088   31.623    0.000
##    .affct.4 (rs_v)    2.768    0.088   31.623    0.000
##    .affct.5 (rs_v)    2.768    0.088   31.623    0.000
##    .affct.6 (rs_v)    2.768    0.088   31.623    0.000</code></pre>
<p>Now, a linear growth model centered at time point 1. The intercept factor estimate, therefore, is the estimated average affect at time 1.</p>
<pre class="r"><code>library(lavaan)

linear_change_string &lt;- &#39;

# Latent intercept and slope factors

intercept_affect =~ 1*affect.1 + 1*affect.2 + 1*affect.3 + 1*affect.4 + 1*affect.5 + 1*affect.6
slope_affect =~ 0*affect.1 + 1*affect.2 + 2*affect.3 + 3*affect.4 + 4*affect.5 + 5*affect.6

# Mean and variance of latent factors

intercept_affect ~~ intercept_affect
slope_affect ~~ slope_affect

# Covariance between latent factors

intercept_affect ~~ slope_affect

# Fix observed variable means to 0

affect.1 ~ 0
affect.2 ~ 0
affect.3 ~ 0
affect.4 ~ 0
affect.5 ~ 0
affect.6 ~ 0

# Constrain residual (error) variance of observed variables to equality across time

affect.1 ~~ res_var*affect.1
affect.2 ~~ res_var*affect.2
affect.3 ~~ res_var*affect.3
affect.4 ~~ res_var*affect.4
affect.5 ~~ res_var*affect.5
affect.6 ~~ res_var*affect.6


&#39;

linear_change_model &lt;- growth(linear_change_string, data = df_wide)
summary(linear_change_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 35 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         11
##   Number of equality constraints                     5
##                                                       
##   Number of observations                           400
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                86.153
##   Degrees of freedom                                21
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              3882.838
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.983
##   Tucker-Lewis Index (TLI)                       0.988
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -4237.893
##   Loglikelihood unrestricted model (H1)      -4194.816
##                                                       
##   Akaike (AIC)                                8487.786
##   Bayesian (BIC)                              8511.734
##   Sample-size adjusted Bayesian (BIC)         8492.696
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.088
##   90 Percent confidence interval - lower         0.069
##   90 Percent confidence interval - upper         0.108
##   P-value RMSEA &lt;= 0.05                          0.001
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.029
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   intercept_affect =~                                    
##     affect.1             1.000                           
##     affect.2             1.000                           
##     affect.3             1.000                           
##     affect.4             1.000                           
##     affect.5             1.000                           
##     affect.6             1.000                           
##   slope_affect =~                                        
##     affect.1             0.000                           
##     affect.2             1.000                           
##     affect.3             2.000                           
##     affect.4             3.000                           
##     affect.5             4.000                           
##     affect.6             5.000                           
## 
## Covariances:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   intercept_affect ~~                                    
##     slope_affect         0.002    0.036    0.049    0.961
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .affect.1          0.000                           
##    .affect.2          0.000                           
##    .affect.3          0.000                           
##    .affect.4          0.000                           
##    .affect.5          0.000                           
##    .affect.6          0.000                           
##     intercept_ffct    4.034    0.153   26.405    0.000
##     slope_affect     -0.703    0.011  -61.911    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     intrcp_           8.773    0.661   13.283    0.000
##     slp_ffc          -0.010    0.004   -2.342    0.019
##    .affct.1 (rs_v)    1.075    0.038   28.284    0.000
##    .affct.2 (rs_v)    1.075    0.038   28.284    0.000
##    .affct.3 (rs_v)    1.075    0.038   28.284    0.000
##    .affct.4 (rs_v)    1.075    0.038   28.284    0.000
##    .affct.5 (rs_v)    1.075    0.038   28.284    0.000
##    .affct.6 (rs_v)    1.075    0.038   28.284    0.000</code></pre>
<pre class="r"><code>inspect(linear_change_model, &#39;cov.lv&#39;)</code></pre>
<pre><code>##                  intrc_ slp_ff
## intercept_affect  8.773       
## slope_affect      0.002 -0.010</code></pre>
<p>This model does an adequate job recovering the intercept and slope parameters.</p>
<p>If I wanted to center the model at time point 3 the latent intercept term would be interpreted as the estimated average affect at time 3 and the syntax would change to:</p>
<pre class="r"><code>&#39;
slope_affect =~ -2*affect.1 + -1*affect.2 + 0*affect.3 + 1*affect.4 + 2*affect.5 + 3*affect.6

&#39;</code></pre>
</div>
<div id="quadratic" class="section level3">
<h3>2) Quadratic</h3>
<p><em>The data generating process:</em></p>
<p><span class="math display">\[\begin{equation}
y_{it} = 4 + 0.2t + 0.7t^2 + e_{t}
\end{equation}\]</span></p>
<pre class="r"><code>library(tidyverse)
library(ggplot2)
library(MASS)

N &lt;- 400
time &lt;- 6



intercept_mu &lt;- 4
linear_growth2 &lt;- 0.2
quad_growth &lt;- 0.7

df_matrix2 &lt;- matrix(, nrow = N*time, ncol = 3)

count &lt;- 0

for(i in 1:400){
  
  unob_het_affect &lt;- rnorm(1,0,3)

  
  for(j in 1:6){
    
    count &lt;- count + 1
    
    if(j == 1){
      
      df_matrix2[count, 1] &lt;- i
      df_matrix2[count, 2] &lt;- j
      df_matrix2[count, 3] &lt;- intercept + rnorm(1,0,1) + rnorm(1,0,1)
    }else{
      
      
      df_matrix2[count, 1] &lt;- i
      df_matrix2[count, 2] &lt;- j
      df_matrix2[count, 3] &lt;- intercept + linear_growth2*j + quad_growth*(j^2) + unob_het_affect + rnorm(1,0,1)
      
    }
    
    
    
  }
  
  
}

df2 &lt;- data.frame(df_matrix2)
names(df2) &lt;- c(&#39;id&#39;, &#39;time&#39;, &#39;affect&#39;)

random_ids2 &lt;- sample(df2$id, 5)

random_df2 &lt;- df2 %&gt;%
  filter(id %in% random_ids2)
  

ggplot(df2, aes(x = time, y = affect, group = id)) + 
  geom_point(color = &#39;gray85&#39;) + 
  geom_line(color = &#39;gray85&#39;) + 
  geom_point(data = random_df2, aes(x = time, y = affect, group = id), color = &#39;blue&#39;) + 
  geom_line(data = random_df2, aes(x = time, y = affect, group = id), color = &#39;blue&#39;) + 
  theme_wsj()</code></pre>
<p><img src="http://christopherdishop.netlify.app/Computational_Notes/latent_growth_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><em>Estimating the model:</em></p>
<p>Quadratic growth model:</p>
<pre class="r"><code>df_wide2 &lt;- reshape(df2, idvar = &#39;id&#39;, timevar = &#39;time&#39;, direction = &#39;wide&#39;)


library(lavaan)

quad_change_string &lt;- &#39;

# Latent intercept, linear slope, and quad slope factors

intercept_affect =~ 1*affect.1 + 1*affect.2 + 1*affect.3 + 1*affect.4 + 1*affect.5 + 1*affect.6
slope_affect =~ 0*affect.1 + 1*affect.2 + 2*affect.3 + 3*affect.4 + 4*affect.5 + 5*affect.6
quad_slope_affect =~ 0*affect.1 + 1*affect.2 + 4*affect.3 + 9*affect.4 + 16*affect.5 + 25*affect.6

# Mean and variance of latent factors

intercept_affect ~~ intercept_affect
slope_affect ~~ slope_affect
quad_slope_affect ~~ quad_slope_affect

# Covariance between latent factors

intercept_affect ~~ slope_affect
intercept_affect ~~ quad_slope_affect
slope_affect ~~ quad_slope_affect

# Fix observed variable means to 0

affect.1 ~ 0
affect.2 ~ 0
affect.3 ~ 0
affect.4 ~ 0
affect.5 ~ 0
affect.6 ~ 0

# Constrain residual (error) variance of observed variables to equality across time

affect.1 ~~ res_var*affect.1
affect.2 ~~ res_var*affect.2
affect.3 ~~ res_var*affect.3
affect.4 ~~ res_var*affect.4
affect.5 ~~ res_var*affect.5
affect.6 ~~ res_var*affect.6


&#39;

quad_change_model &lt;- growth(quad_change_string, data = df_wide2)
summary(quad_change_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 104 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         15
##   Number of equality constraints                     5
##                                                       
##   Number of observations                           400
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                               585.572
##   Degrees of freedom                                17
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              3053.276
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.813
##   Tucker-Lewis Index (TLI)                       0.835
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -4572.514
##   Loglikelihood unrestricted model (H1)      -4279.729
##                                                       
##   Akaike (AIC)                                9165.029
##   Bayesian (BIC)                              9204.944
##   Sample-size adjusted Bayesian (BIC)         9173.213
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.289
##   90 Percent confidence interval - lower         0.269
##   90 Percent confidence interval - upper         0.309
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.238
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                        Estimate  Std.Err  z-value  P(&gt;|z|)
##   intercept_affect =~                                     
##     affect.1              1.000                           
##     affect.2              1.000                           
##     affect.3              1.000                           
##     affect.4              1.000                           
##     affect.5              1.000                           
##     affect.6              1.000                           
##   slope_affect =~                                         
##     affect.1              0.000                           
##     affect.2              1.000                           
##     affect.3              2.000                           
##     affect.4              3.000                           
##     affect.5              4.000                           
##     affect.6              5.000                           
##   quad_slope_affect =~                                    
##     affect.1              0.000                           
##     affect.2              1.000                           
##     affect.3              4.000                           
##     affect.4              9.000                           
##     affect.5             16.000                           
##     affect.6             25.000                           
## 
## Covariances:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   intercept_affect ~~                                    
##     slope_affect         0.896    0.139    6.455    0.000
##     quad_slop_ffct      -0.131    0.022   -5.912    0.000
##   slope_affect ~~                                        
##     quad_slop_ffct      -0.382    0.044   -8.740    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .affect.1          0.000                           
##    .affect.2          0.000                           
##    .affect.3          0.000                           
##    .affect.4          0.000                           
##    .affect.5          0.000                           
##    .affect.6          0.000                           
##     intercept_ffct    4.126    0.068   60.498    0.000
##     slope_affect      2.166    0.098   22.194    0.000
##     quad_slop_ffct    0.613    0.016   39.281    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     intrcp_           0.522    0.142    3.662    0.000
##     slp_ffc           2.626    0.274    9.593    0.000
##     qd_slp_           0.054    0.007    7.546    0.000
##    .affct.1 (rs_v)    1.630    0.067   24.495    0.000
##    .affct.2 (rs_v)    1.630    0.067   24.495    0.000
##    .affct.3 (rs_v)    1.630    0.067   24.495    0.000
##    .affct.4 (rs_v)    1.630    0.067   24.495    0.000
##    .affct.5 (rs_v)    1.630    0.067   24.495    0.000
##    .affct.6 (rs_v)    1.630    0.067   24.495    0.000</code></pre>
<p>This model recovers the intercept and quadratic parameters but not the linear growth parameter.</p>
</div>
<div id="latent-basis" class="section level3">
<h3>3) Latent Basis</h3>
<p>This model allows us to see where a majority of the change occurs in the process. For example, does more change occur between time points 2 and 3 or 5 and 6? In this model we are not trying to recover the parameters, but describe the change process in detail.</p>
<p><em>Data generating process:</em></p>
<p>Time 1 - Time 3:
<span class="math display">\[\begin{equation}
y_{it} = 4 + 0.2t + e_{t}
\end{equation}\]</span></p>
<p>Time 4 - Time 6:
<span class="math display">\[\begin{equation}
y_{it} = 4 + 0.8t + e_{t}
\end{equation}\]</span></p>
<pre class="r"><code>library(tidyverse)
library(ggplot2)
library(MASS)

N &lt;- 400
time &lt;- 6


intercept_mu &lt;- 4
growth_1 &lt;- 0.2
growth_2 &lt;- 0.8


df_matrix3 &lt;- matrix(, nrow = N*time, ncol = 3)

count &lt;- 0

for(i in 1:400){
  
  unob_het_affect &lt;- rnorm(1,0,3)
  
  
  for(j in 1:6){
    
    count &lt;- count + 1
    
    if(j &lt; 4){
      
      df_matrix3[count, 1] &lt;- i
      df_matrix3[count, 2] &lt;- j
      df_matrix3[count, 3] &lt;- intercept + growth_1*j + unob_het_affect + rnorm(1,0,1)
      
    }else{
      
      
      df_matrix3[count, 1] &lt;- i
      df_matrix3[count, 2] &lt;- j
      df_matrix3[count, 3] &lt;- intercept + growth_2*j + unob_het_affect + rnorm(1,0,1)
      
    }
    
    
    
  }
  
  
}

df3 &lt;- data.frame(df_matrix3)
names(df3) &lt;- c(&#39;id&#39;, &#39;time&#39;, &#39;affect&#39;)

random_ids3 &lt;- sample(df3$id, 5)

random_df3 &lt;- df3 %&gt;%
  filter(id %in% random_ids3)
  

ggplot(df3, aes(x = time, y = affect, group = id)) + 
  geom_point(color = &#39;gray85&#39;) + 
  geom_line(color = &#39;gray85&#39;) + 
  geom_point(data = random_df3, aes(x = time, y = affect, group = id), color = &#39;blue&#39;) + 
  geom_line(data = random_df3, aes(x = time, y = affect, group = id), color = &#39;blue&#39;) + 
  theme_wsj()</code></pre>
<p><img src="http://christopherdishop.netlify.app/Computational_Notes/latent_growth_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><em>Estimating the model:</em></p>
<p>Latent basis:</p>
<p>Similar to a linear growth model but we freely estimate the intermediate basis coefficients. Remember to constrain the first basis coefficient to zero and the last to 1.</p>
<pre class="r"><code>df_wide3 &lt;- reshape(df3, idvar = &#39;id&#39;, timevar = &#39;time&#39;, direction = &#39;wide&#39;)


library(lavaan)

lb_string &lt;- &#39;

# Latent intercept and slope terms with intermediate time points freely estimated

intercept_affect =~ 1*affect.1 + 1*affect.2 + 1*affect.3 + 1*affect.4 + 1*affect.5 + 1*affect.6
slope_affect =~ 0*affect.1 + bc1*affect.2 + bc2*affect.3 + bc3*affect.4 + bc4*affect.5 + 1*affect.6

# Mean and variance of latent factors

intercept_affect ~~ intercept_affect
slope_affect ~~ slope_affect

# Covariance between latent factors

intercept_affect ~~ slope_affect

# Fix observed variable means to 0

affect.1 ~ 0
affect.2 ~ 0
affect.3 ~ 0
affect.4 ~ 0
affect.5 ~ 0
affect.6 ~ 0

# Constrain residual (error) variance of observed variables to equality across time

affect.1 ~~ res_var*affect.1
affect.2 ~~ res_var*affect.2
affect.3 ~~ res_var*affect.3
affect.4 ~~ res_var*affect.4
affect.5 ~~ res_var*affect.5
affect.6 ~~ res_var*affect.6


&#39;

lb_model &lt;- growth(lb_string, data = df_wide3)
summary(lb_model, fit.measures = T)</code></pre>
<pre><code>## lavaan 0.6-6 ended normally after 70 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         15
##   Number of equality constraints                     5
##                                                       
##   Number of observations                           400
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                 7.046
##   Degrees of freedom                                17
##   P-value (Chi-square)                           0.983
## 
## Model Test Baseline Model:
## 
##   Test statistic                              3960.476
##   Degrees of freedom                                15
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.002
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -4259.391
##   Loglikelihood unrestricted model (H1)      -4255.868
##                                                       
##   Akaike (AIC)                                8538.782
##   Bayesian (BIC)                              8578.697
##   Sample-size adjusted Bayesian (BIC)         8546.966
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.000
##   P-value RMSEA &lt;= 0.05                          1.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.009
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   intercept_affect =~                                    
##     affect.1             1.000                           
##     affect.2             1.000                           
##     affect.3             1.000                           
##     affect.4             1.000                           
##     affect.5             1.000                           
##     affect.6             1.000                           
##   slope_affect =~                                        
##     affect.1             0.000                           
##     affect.2 (bc1)       0.050    0.015    3.364    0.001
##     affect.3 (bc2)       0.101    0.015    6.885    0.000
##     affect.4 (bc3)       0.672    0.014   49.677    0.000
##     affect.5 (bc4)       0.826    0.014   58.253    0.000
##     affect.6             1.000                           
## 
## Covariances:
##                       Estimate  Std.Err  z-value  P(&gt;|z|)
##   intercept_affect ~~                                    
##     slope_affect         0.105    0.168    0.622    0.534
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .affect.1          0.000                           
##    .affect.2          0.000                           
##    .affect.3          0.000                           
##    .affect.4          0.000                           
##    .affect.5          0.000                           
##    .affect.6          0.000                           
##     intercept_ffct    4.051    0.162   25.049    0.000
##     slope_affect      4.677    0.073   64.038    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     intrcp_           9.433    0.694   13.597    0.000
##     slp_ffc           0.080    0.088    0.902    0.367
##    .affct.1 (rs_v)    1.027    0.036   28.284    0.000
##    .affct.2 (rs_v)    1.027    0.036   28.284    0.000
##    .affct.3 (rs_v)    1.027    0.036   28.284    0.000
##    .affct.4 (rs_v)    1.027    0.036   28.284    0.000
##    .affct.5 (rs_v)    1.027    0.036   28.284    0.000
##    .affct.6 (rs_v)    1.027    0.036   28.284    0.000</code></pre>
<p><code>bc1</code> represents the percentage of change for the average individual between time 1 and 2. <code>bc2</code> represents the percentage change betwen time 1 and 3, <code>bc4</code> is the percentage change between time 1 and 5, etc.</p>
<p>Bo<span class="math inline">\(^2\)</span>m =)</p>
</div>
</div>

  </article>
</section>

  

      </div>

      
  <footer class="footer">
    <section class="container">
      
      
        ©
        
          2016 -
        
        2020
         Christopher R. Dishop 
      
      
         · 
        Generated with <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
      
      
        
      


      

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    
    </section>
  </footer>


    </main>

    

    

    <script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, '//analytics.example.com/tracker.js', 'fathom');
fathom('set', 'siteId', 'ABCDE');
fathom('trackPageview');
</script>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/atom-one-dark.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>


  </body>



</html>
